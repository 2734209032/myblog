<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>为什么js代码会出现爆栈 | hyh的博客</title>
    <meta name="generator" content="VuePress 1.9.9">
    <link rel="stylesheet" href="/myblog/styles/custom.css">
    <meta name="description" content="YYY">
    
    <link rel="preload" href="/myblog/assets/css/0.styles.99ff47a3.css" as="style"><link rel="preload" href="/myblog/assets/js/app.67ec3bdb.js" as="script"><link rel="preload" href="/myblog/assets/js/2.dd8fbd6f.js" as="script"><link rel="preload" href="/myblog/assets/js/5.ab7fc5be.js" as="script"><link rel="prefetch" href="/myblog/assets/js/10.a692fbd4.js"><link rel="prefetch" href="/myblog/assets/js/11.08388110.js"><link rel="prefetch" href="/myblog/assets/js/12.9304c561.js"><link rel="prefetch" href="/myblog/assets/js/13.875e3a6f.js"><link rel="prefetch" href="/myblog/assets/js/14.e3ed33ee.js"><link rel="prefetch" href="/myblog/assets/js/15.ef10c68f.js"><link rel="prefetch" href="/myblog/assets/js/16.2fb0e083.js"><link rel="prefetch" href="/myblog/assets/js/17.7e5bedb7.js"><link rel="prefetch" href="/myblog/assets/js/18.867a9263.js"><link rel="prefetch" href="/myblog/assets/js/19.b5993274.js"><link rel="prefetch" href="/myblog/assets/js/20.828b7b6c.js"><link rel="prefetch" href="/myblog/assets/js/21.4efad3bc.js"><link rel="prefetch" href="/myblog/assets/js/22.93df3f05.js"><link rel="prefetch" href="/myblog/assets/js/23.3df291bb.js"><link rel="prefetch" href="/myblog/assets/js/24.d714e6bf.js"><link rel="prefetch" href="/myblog/assets/js/25.4e628230.js"><link rel="prefetch" href="/myblog/assets/js/26.02d443e0.js"><link rel="prefetch" href="/myblog/assets/js/27.229fb0aa.js"><link rel="prefetch" href="/myblog/assets/js/28.19c55917.js"><link rel="prefetch" href="/myblog/assets/js/29.62aa02e9.js"><link rel="prefetch" href="/myblog/assets/js/3.39ee49ac.js"><link rel="prefetch" href="/myblog/assets/js/30.058aeae2.js"><link rel="prefetch" href="/myblog/assets/js/31.f836c422.js"><link rel="prefetch" href="/myblog/assets/js/32.46555af3.js"><link rel="prefetch" href="/myblog/assets/js/33.f56c013e.js"><link rel="prefetch" href="/myblog/assets/js/34.bd9f63a1.js"><link rel="prefetch" href="/myblog/assets/js/35.d743471b.js"><link rel="prefetch" href="/myblog/assets/js/36.077f181c.js"><link rel="prefetch" href="/myblog/assets/js/37.d0b5c7d8.js"><link rel="prefetch" href="/myblog/assets/js/38.2cfdc63a.js"><link rel="prefetch" href="/myblog/assets/js/39.855e7558.js"><link rel="prefetch" href="/myblog/assets/js/4.e647fabc.js"><link rel="prefetch" href="/myblog/assets/js/40.2a3c09fb.js"><link rel="prefetch" href="/myblog/assets/js/41.850c0782.js"><link rel="prefetch" href="/myblog/assets/js/42.aad90931.js"><link rel="prefetch" href="/myblog/assets/js/43.84ae1707.js"><link rel="prefetch" href="/myblog/assets/js/44.786e98ec.js"><link rel="prefetch" href="/myblog/assets/js/45.c854bb25.js"><link rel="prefetch" href="/myblog/assets/js/46.2faccb6b.js"><link rel="prefetch" href="/myblog/assets/js/47.a3721fe4.js"><link rel="prefetch" href="/myblog/assets/js/48.c6fd4fbd.js"><link rel="prefetch" href="/myblog/assets/js/49.27d7f1e1.js"><link rel="prefetch" href="/myblog/assets/js/50.07901204.js"><link rel="prefetch" href="/myblog/assets/js/51.421c10a9.js"><link rel="prefetch" href="/myblog/assets/js/52.9d64c6f3.js"><link rel="prefetch" href="/myblog/assets/js/53.8e83d8ba.js"><link rel="prefetch" href="/myblog/assets/js/54.d4b1503b.js"><link rel="prefetch" href="/myblog/assets/js/55.0c1150d7.js"><link rel="prefetch" href="/myblog/assets/js/56.6764b289.js"><link rel="prefetch" href="/myblog/assets/js/57.3baaab80.js"><link rel="prefetch" href="/myblog/assets/js/58.c1af3651.js"><link rel="prefetch" href="/myblog/assets/js/59.3c946394.js"><link rel="prefetch" href="/myblog/assets/js/6.996ed3a0.js"><link rel="prefetch" href="/myblog/assets/js/60.71e29c5d.js"><link rel="prefetch" href="/myblog/assets/js/61.5a09e80e.js"><link rel="prefetch" href="/myblog/assets/js/62.b96b02ee.js"><link rel="prefetch" href="/myblog/assets/js/63.9b9860ad.js"><link rel="prefetch" href="/myblog/assets/js/64.2c44e38f.js"><link rel="prefetch" href="/myblog/assets/js/65.b53500bd.js"><link rel="prefetch" href="/myblog/assets/js/66.36c974d0.js"><link rel="prefetch" href="/myblog/assets/js/67.d8808437.js"><link rel="prefetch" href="/myblog/assets/js/68.66d60f36.js"><link rel="prefetch" href="/myblog/assets/js/69.00a72619.js"><link rel="prefetch" href="/myblog/assets/js/7.97e4b019.js"><link rel="prefetch" href="/myblog/assets/js/70.1ec7f6c6.js"><link rel="prefetch" href="/myblog/assets/js/71.ccf10280.js"><link rel="prefetch" href="/myblog/assets/js/72.d820e71e.js"><link rel="prefetch" href="/myblog/assets/js/73.d4b547e5.js"><link rel="prefetch" href="/myblog/assets/js/74.21611aa5.js"><link rel="prefetch" href="/myblog/assets/js/75.9bdf7dad.js"><link rel="prefetch" href="/myblog/assets/js/76.791addff.js"><link rel="prefetch" href="/myblog/assets/js/77.fdb935e6.js"><link rel="prefetch" href="/myblog/assets/js/78.28c527d5.js"><link rel="prefetch" href="/myblog/assets/js/79.c9e40709.js"><link rel="prefetch" href="/myblog/assets/js/8.087c4b01.js"><link rel="prefetch" href="/myblog/assets/js/80.de18b040.js"><link rel="prefetch" href="/myblog/assets/js/81.c800f833.js"><link rel="prefetch" href="/myblog/assets/js/82.00bae400.js"><link rel="prefetch" href="/myblog/assets/js/83.35b8c102.js"><link rel="prefetch" href="/myblog/assets/js/84.3389ac8e.js"><link rel="prefetch" href="/myblog/assets/js/85.61a46c92.js"><link rel="prefetch" href="/myblog/assets/js/86.2ec2b9b4.js"><link rel="prefetch" href="/myblog/assets/js/9.429ff6ae.js">
    <link rel="stylesheet" href="/myblog/assets/css/0.styles.99ff47a3.css">
  </head>
  <body class="theme-mode-light">
    <div id="app" data-server-rendered="true"><div class="theme-container sidebar-open have-rightmenu"><header class="navbar blur"><div title="目录" class="sidebar-button"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512" class="icon"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div> <a href="/myblog/" class="home-link router-link-active"><!----> <span class="site-name">hyh的博客</span></a> <div class="links"><div class="search-box"><input aria-label="Search" autocomplete="off" spellcheck="false" value=""> <!----></div> <nav class="nav-links can-hide"><div class="nav-item"><a href="/myblog/" class="nav-link">首页</a></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="前端三剑客" class="dropdown-title"><!----> <span class="title" style="display:;">前端三剑客</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/myblog/blogs/basics/html/" class="nav-link">HTML</a></li><li class="dropdown-item"><!----> <a href="/myblog/blogs/basics/css/" class="nav-link">CSS</a></li><li class="dropdown-item"><!----> <a href="/myblog/blogs/basics/javascript/" class="nav-link">JavaScript</a></li></ul></div></div><div class="nav-item"><a href="/myblog/blogs/basics/data.html" class="nav-link">前端资料网站</a></div><div class="nav-item"><a href="/myblog/blogs/basics/i18n.html" class="nav-link">国际化i18n</a></div> <!----></nav></div></header> <div class="sidebar-mask"></div> <div class="sidebar-hover-trigger"></div> <aside class="sidebar" style="display:none;"><!----> <nav class="nav-links"><div class="nav-item"><a href="/myblog/" class="nav-link">首页</a></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="前端三剑客" class="dropdown-title"><!----> <span class="title" style="display:;">前端三剑客</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/myblog/blogs/basics/html/" class="nav-link">HTML</a></li><li class="dropdown-item"><!----> <a href="/myblog/blogs/basics/css/" class="nav-link">CSS</a></li><li class="dropdown-item"><!----> <a href="/myblog/blogs/basics/javascript/" class="nav-link">JavaScript</a></li></ul></div></div><div class="nav-item"><a href="/myblog/blogs/basics/data.html" class="nav-link">前端资料网站</a></div><div class="nav-item"><a href="/myblog/blogs/basics/i18n.html" class="nav-link">国际化i18n</a></div> <!----></nav>  <ul class="sidebar-links"><li><a href="/myblog/" aria-current="page" class="sidebar-link">博客简介</a></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>面试篇</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>js基础篇</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>es6基础篇</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>ajax基础篇</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>git基础篇</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>vue2基础篇</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>vue3基础篇</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>react基础篇</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>node基础篇</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>lodash基础篇</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>小程序基础篇</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading open"><span>浏览器基础篇</span> <span class="arrow down"></span></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/myblog/pages/e3ff84/" class="sidebar-link">浏览器工作原理</a></li><li><a href="/myblog/pages/9d7fbf/" class="sidebar-link">js执行逻辑</a></li><li><a href="/myblog/pages/497ad2/" aria-current="page" class="active sidebar-link">为什么js代码会出现爆栈</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header level2"><a href="/myblog/pages/497ad2/#_1-调用栈" class="sidebar-link">1.调用栈</a></li><li class="sidebar-sub-header level2"><a href="/myblog/pages/497ad2/#_2-什么是函数调用" class="sidebar-link">2.什么是函数调用</a></li><li class="sidebar-sub-header level2"><a href="/myblog/pages/497ad2/#_3-什么是栈" class="sidebar-link">3.什么是栈</a></li><li class="sidebar-sub-header level2"><a href="/myblog/pages/497ad2/#_4-什么是-javascript-的调用栈" class="sidebar-link">4.什么是 JavaScript 的调用栈</a></li><li class="sidebar-sub-header level2"><a href="/myblog/pages/497ad2/#_5-在开发中-如何利用好调用栈" class="sidebar-link">5.在开发中，如何利用好调用栈</a></li></ul></li><li><a href="/myblog/pages/c27c66/" class="sidebar-link">var缺陷</a></li><li><a href="/myblog/pages/9f5968/" class="sidebar-link">作用域链和闭包</a></li><li><a href="/myblog/pages/5fd9c7/" class="sidebar-link">this</a></li><li><a href="/myblog/pages/b579cc/" class="sidebar-link">堆和栈</a></li><li><a href="/myblog/pages/2b1549/" class="sidebar-link">垃圾回收</a></li><li><a href="/myblog/pages/0d2221/" class="sidebar-link">v8是怎样执行一段代码的</a></li><li><a href="/myblog/pages/94b8d4/" class="sidebar-link">setTimeout是怎么实现的</a></li></ul></section></li></ul> </aside> <div><main class="page"><div class="theme-vdoing-wrapper "><div class="articleInfo-wrap" data-v-41062720><div class="articleInfo" data-v-41062720><ul class="breadcrumbs" data-v-41062720><li data-v-41062720><a href="/myblog/" title="首页" class="iconfont icon-home router-link-active" data-v-41062720></a></li> <li data-v-41062720><a href="/myblog/categories/?category=blogs" title="分类" data-v-41062720>blogs</a></li><li data-v-41062720><a href="/myblog/categories/?category=browser" title="分类" data-v-41062720>browser</a></li></ul> <div class="info" data-v-41062720><!----> <div title="创建时间" class="date iconfont icon-riqi" data-v-41062720><a href="javascript:;" data-v-41062720>2023-07-07</a></div> <!----></div></div></div> <!----> <div class="content-wrapper"><div class="right-menu-wrapper"><div class="right-menu-margin"><div class="right-menu-title">目录</div> <div class="right-menu-content"></div></div></div> <h1><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAB4AAAAeCAYAAAA7MK6iAAAAAXNSR0IArs4c6QAABGpJREFUSA3tVVtoXFUU3fvOI53UlmCaKIFmwEhsE7QK0ipFEdHEKpXaZGrp15SINsXUWvBDpBgQRKi0+KKoFeJHfZA+ED9KKoIU2gYD9UejTW4rVIzm0VSTziPzuNu1z507dibTTjL4U/DAzLn3nL3X2o91ziX6f9wMFdh6Jvbm9nNSV0msViVO6tN1Rm7NMu2OpeJ9lWBUTDxrJbYTS0hInuwciu9eLHlFxCLCZEk3MegsJmZ5K/JD6t7FkFdEvGUo1g7qJoG3MHImqRIn8/nzY1K9UPKKiJmtnUqHVE3Gbuay6vJE/N2FEmuxFjW2nUuE0yQXRRxLiTUAzs36zhZvOXJPdX850EVnnLZkB8prodQoM5JGj7Xk2mvC7JB8tG04Ef5PiXtG0UtxupRQSfTnBoCy554x18yJHI6I+G5Eru4LHmPJZEQsrvPUbMiA8G/WgMK7w7I+ez7++o2ANfbrjvaOl1tFMs+htG3IrZH9/hDX1Pr8Tc0UvH8tcX29KzAgIGcEkINyW5BF9x891hw6VYqgJHEk0huccS7vh3C6gTiODL+26huuBtbct8eZnqLML8PkxGYpuPZBqtqwkSjgc4mB5gbgig5i+y0UDK35LMxXisn9xQtK+nd26gTIHsHe/oblK/b29fUmN/8Y+9jAQrnBp56m1LcDlDp9irKTExSKduXJVWSqdBMA08pEJnEIOB3FPPMybu/oeV8zFeYN3xx576Q6RH+VmplE4ncQV5v+5rzSoyOU7PuEAg8g803PwBJ0CExno/jcMbN8tONYeOmHiuUNryvm3fRUy4tMPVLdAGkUhNWuggGrJcXPv+ouCjz0MKUHz1J2/E8IC9nqTabcxgaBYM0hPhD5Y65FsbxRQKxCQrDjDctW7PUM3HuZunFyifSAqEfuzCp48Il24luWUWZoyJCaPR82jE0+kFA643wRFVni4RYSq3ohJO2pZ7B5dO4xkDWbEpossJPLSrPjYID8rS2UHTlvyNxqIGsg674XJJ7vnh5L7PNwC4hh2sjCI96mzszOTpxLF0T7l88Yz7lAuK6OnL8gXLOnTvpzSb22YG8W7us3jSebFHeeqnXRG1vt+MoUM84LQIBmMsCTAcOauTh0T0l0neQK7m2bLMt2mGxU3HYssS0J2cdv5wljlPsrIuZLAG/2DOZIXgCYT8uMGZN+e2kSirfxZOPCsC0f24nTZzspnVn9VePS1Z5vubmAGGXG8ZFno9Hel0yfA5ZPhF7Dh972BQJ2qCpgH67lmWtBYbvk6sz02wjky2vXyz0XErP/kFB619js1BtwfOV4OPRqOQBjy3Qbk18vigUPPSD5ceHnwck7W9bhAqZdd7SuG7w4/P2F/GaJh8c7e9qgow+Q7cGBo+98WsLkuktFqiZabtXuQTu/Y5ETbR0v7tNSFnvrmu6pjdoan2KjMu8q/Hmj1EfCO2ZGfEIbIXKUlw8qaX9/b2oeSJmFksSeT/Fn0V3nSypChh4Gjh74ybO9aeZ/AN2dwciu2/MhAAAAAElFTkSuQmCC">为什么js代码会出现爆栈<!----></h1> <!----> <div class="theme-vdoing-content content__default"><h2 id="_1-调用栈"><a href="#_1-调用栈" class="header-anchor">#</a> 1.调用栈</h2> <p>``调用栈就是用来管理函数调用关系的一种数据结构。`</p> <h2 id="_2-什么是函数调用"><a href="#_2-什么是函数调用" class="header-anchor">#</a> 2.什么是函数调用</h2> <div class="language-js line-numbers-mode"><pre class="language-js"><code>函数调用就是运行一个函数，具体使用方式是使用函数名称跟着一对小括号。
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><div class="language-js line-numbers-mode"><pre class="language-js"><code><span class="token keyword">var</span> a <span class="token operator">=</span> <span class="token number">2</span>
<span class="token keyword">function</span> <span class="token function">add</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
<span class="token keyword">var</span> b <span class="token operator">=</span> <span class="token number">10</span>
<span class="token keyword">return</span> a<span class="token operator">+</span>b
<span class="token punctuation">}</span>
<span class="token function">add</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br></div></div><div class="language-js line-numbers-mode"><pre class="language-js"><code><span class="token comment">//在执行到函数 add() 之前，JavaScript 引擎会为上面这段代码创建全局执行上下文，包含了声明的函数和变量</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><p><img src="/myblog/assets/img/image-20230707211259223.784a832d.png" alt="Algolia搜索"></p> <div class="language-js line-numbers-mode"><pre class="language-js"><code><span class="token comment">//代码中全局变量和函数都保存在全局上下文的变量环境中。执行上下文准备好之后，便开始执行全局代码，当执行到 add 这儿时，JavaScript 判断这是一个函数调用，那么将执行以下操作：首先，从全局执行上下文中，取出 add 函数代码。其次，对 add 函数的这段代码进行编译，并创建该函数的执行上下文和可执行代码。最后，执行代码，输出结果。就这样，当执行到 add 函数的时候，我们就有了两个执行上下文了——全局执行上下文和add 函数的执行上下文。</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><p><img src="/myblog/assets/img/image-20230707211326922.3a24734a.png" alt="Algolia搜索"></p> <div class="language-js line-numbers-mode"><pre class="language-js"><code><span class="token operator">/</span>也就是说在执行 JavaScript 时，可能会存在多个执行上下文，那么 JavaScript 引擎是如何管理这些执行上下文的呢？
<span class="token comment">//答案：通过一种叫栈的数据结构来管理的</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br></div></div><h2 id="_3-什么是栈"><a href="#_3-什么是栈" class="header-anchor">#</a> 3.什么是栈</h2> <div class="language-js line-numbers-mode"><pre class="language-js"><code><span class="token number">1.</span>关于栈，你可以结合这么一个贴切的例子来理解，一条单车道的单行线，一端被堵住了，而另一端入口处没有任何提示信息，堵住之后就只能后进去的车子先出来，这时这个堵住的单行线就可以被看作是一个栈容器，车子开进单行线的操作叫做入栈，车子倒出去的操作叫做出栈。
<span class="token number">2.</span>在车流量较大的场景中，就会发生反复的入栈、栈满、出栈、空栈和再次入栈，一直循环。所以，栈就是类似于一端被堵住的单行线，车子类似于栈中的元素，栈中的元素满足后进先出的特点。
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br></div></div><p><img src="/myblog/assets/img/image-20230707211338241.9a06d0c3.png" alt="Algolia搜索"></p> <h2 id="_4-什么是-javascript-的调用栈"><a href="#_4-什么是-javascript-的调用栈" class="header-anchor">#</a> 4.什么是 JavaScript 的调用栈</h2> <div class="language-js line-numbers-mode"><pre class="language-js"><code>JavaScript 引擎正是利用栈的这种结构来管理执行上下文的。在执行上下文创建好后，JavaScript 引擎会将执行上下文压入栈中，通常把这种用来管理执行上下文的栈称为执行上下文栈，又称调用栈。
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><div class="language-js line-numbers-mode"><pre class="language-js"><code>为便于你更好地理解调用栈，下面我们再来看段稍微复杂点的示例代码：
<span class="token keyword">var</span> a <span class="token operator">=</span> <span class="token number">2</span>
<span class="token keyword">function</span> <span class="token function">add</span><span class="token punctuation">(</span><span class="token parameter">b<span class="token punctuation">,</span>c</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
 <span class="token keyword">return</span> b<span class="token operator">+</span>c
<span class="token punctuation">}</span>
<span class="token keyword">function</span> <span class="token function">addAll</span><span class="token punctuation">(</span><span class="token parameter">b<span class="token punctuation">,</span>c</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
<span class="token keyword">var</span> d <span class="token operator">=</span> <span class="token number">10</span>
result <span class="token operator">=</span> <span class="token function">add</span><span class="token punctuation">(</span>b<span class="token punctuation">,</span>c<span class="token punctuation">)</span>
<span class="token keyword">return</span> a<span class="token operator">+</span>result<span class="token operator">+</span>d
<span class="token punctuation">}</span>
<span class="token function">addAll</span><span class="token punctuation">(</span><span class="token number">3</span><span class="token punctuation">,</span><span class="token number">6</span><span class="token punctuation">)</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br></div></div><p><strong>执行过程</strong></p> <div class="language-js line-numbers-mode"><pre class="language-js"><code>第一步，创建全局上下文，并将其压入栈底
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><p><img src="/myblog/assets/img/image-20230707211410053.35859807.png" alt="Algolia搜索"></p> <div class="language-js line-numbers-mode"><pre class="language-js"><code>全局执行上下文压入到调用栈后，JavaScript 引擎便开始执行全局代码了。首先会执行a<span class="token operator">=</span><span class="token number">2</span> 的赋值操作，执行该语句会将全局上下文变量环境中 a 的值设置为 <span class="token number">2</span>。设置后的全局上下文的状态如下图所示：
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><p><img src="/myblog/assets/img/image-20230707211420865.b53bc1ce.png" alt="Algolia搜索"></p> <div class="language-js line-numbers-mode"><pre class="language-js"><code>第二步是调用 addAll 函数。当调用该函数时，JavaScript 引擎会编译该函数，并为其创建一个执行上下文，最后还将该函数的执行上下文压入栈中，如下图所示：  addAll 函数的执行上下文创建好之后，便进入了函数代码的执行阶段了，这里先执行的是d<span class="token operator">=</span><span class="token number">10</span> 的赋值操作，执行语句会将 addAll 函数执行上下文中的 d 由 <span class="token keyword">undefined</span> 变成了<span class="token number">10</span>。
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><p><img src="/myblog/assets/img/image-20230707211457392.1073f0ff.png" alt="Algolia搜索"></p> <div class="language-js line-numbers-mode"><pre class="language-js"><code>然后接着往下执行，第三步，当执行到 add 函数调用语句时，同样会为其创建执行上下文，并将其压入调用栈，如下图所示：
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><p><img src="/myblog/assets/img/image-20230707211511025.9881cac8.png" alt="Algolia搜索"></p> <div class="language-js line-numbers-mode"><pre class="language-js"><code>当 add 函数返回时，该函数的执行上下文就会从栈顶弹出，并将 result 的值设置为 add函数的返回值，也就是 <span class="token number">9</span>。如下图所示：
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><p><img src="/myblog/assets/img/image-20230707211522415.8acb4d28.png" alt="Algolia搜索"></p> <div class="language-js line-numbers-mode"><pre class="language-js"><code>紧接着 addAll 执行最后一个相加操作后并返回，addAll 的执行上下文也会从栈顶部弹出，此时调用栈中就只剩下全局上下文了。最终如下图所示：
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><p><img src="/myblog/assets/img/image-20230707211534293.7e84b366.png" alt="Algolia搜索"></p> <div class="language-js line-numbers-mode"><pre class="language-js"><code>至此，整个 JavaScript 流程执行结束了。
<span class="token comment">//调用栈是 JavaScript 引擎追踪函数执行的一个机制，当一次有多个函数被调用时，通过调用栈就能够追踪到哪个函数正在被执行以及各函数之间的调用关系。</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br></div></div><h2 id="_5-在开发中-如何利用好调用栈"><a href="#_5-在开发中-如何利用好调用栈" class="header-anchor">#</a> 5.在开发中，如何利用好调用栈</h2> <h3 id="_5-1如何利用浏览器查看调用栈的信息"><a href="#_5-1如何利用浏览器查看调用栈的信息" class="header-anchor">#</a> 5.1如何利用浏览器查看调用栈的信息</h3> <div class="language-js line-numbers-mode"><pre class="language-js"><code>我们拿上面的那段代码做个演示，你可以打开“开发者工具”，点击“Source”标签，选择 JavaScript 代码的页面，然后在第 <span class="token number">3</span> 行加上断点，并刷新页面。你可以看到执行到 add 函数时，执行流程就暂停了，这时可以通过右边“callstack”来查看当前的调用栈的情况，如下图：
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><p><img src="/myblog/assets/img/image-20230707211609208.64f9e064.png" alt="Algolia搜索"></p> <div class="language-js line-numbers-mode"><pre class="language-js"><code><span class="token number">1.</span>从图中可以看出，右边的“call stack”下面显示出来了当前函数被调用关系：栈的最底部是anonymous，也就是全局的函数入口；中间是 addAll 函数；顶部是 add 函数。这就清晰地反映了函数的调用关系，所以在分析复杂结构代码，或者检查 Bug 时，调用栈都是非常有用的。
<span class="token number">2.</span>除了通过断点来查看调用栈，你还可以使用 console<span class="token punctuation">.</span><span class="token function">trace</span><span class="token punctuation">(</span><span class="token punctuation">)</span> 来输出当前的函数调用关系，比如在示例代码中的 add 函数里面加上了 console<span class="token punctuation">.</span><span class="token function">trace</span><span class="token punctuation">(</span><span class="token punctuation">)</span>，你就可以看到控制台输出的结果，如下图：
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br></div></div><p><img src="/myblog/assets/img/image-20230707211625303.f456241c.png" alt="Algolia搜索"></p> <h3 id="_5-2栈溢出-stack-overflow"><a href="#_5-2栈溢出-stack-overflow" class="header-anchor">#</a> 5.2栈溢出（Stack Overflow）</h3> <div class="language-js line-numbers-mode"><pre class="language-js"><code>调用栈是有大小的，当入栈的执行上下文超过一定数目，JavaScript 引擎就会报错，我们把这种错误叫做栈溢出。
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><h3 id="_5-3总结"><a href="#_5-3总结" class="header-anchor">#</a> 5.3总结</h3> <div class="language-js line-numbers-mode"><pre class="language-js"><code>每调用一个函数，JavaScript 引擎会为其创建执行上下文，并把该执行上下文压入调用栈，然后 JavaScript 引擎开始执行函数代码。
如果在一个函数 <span class="token constant">A</span> 中调用了另外一个函数 <span class="token constant">B</span>，那么 JavaScript 引擎会为 <span class="token constant">B</span> 函数创建执行上下文，并将 <span class="token constant">B</span> 函数的执行上下文压入栈顶。
当前函数执行完毕后，JavaScript 引擎会将该函数的执行上下文弹出栈。当分配的调用栈空间被占满时，会引发“堆栈溢出”问题。
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br></div></div></div></div> <!----> <div class="page-edit"><!----> <!----> <!----></div> <div class="page-nav-wapper"><div class="page-nav-centre-wrap"><a href="/myblog/pages/9d7fbf/" class="page-nav-centre page-nav-centre-prev"><div class="tooltip">js执行逻辑</div></a> <a href="/myblog/pages/c27c66/" class="page-nav-centre page-nav-centre-next"><div class="tooltip">var缺陷</div></a></div> <div class="page-nav"><p class="inner"><span class="prev">
        ←
        <a href="/myblog/pages/9d7fbf/" class="prev">js执行逻辑</a></span> <span class="next"><a href="/myblog/pages/c27c66/">var缺陷</a>→
      </span></p></div></div></div> <div class="article-list"><div class="article-title"><a href="/myblog/archives/" class="iconfont icon-bi">最近更新</a></div> <div class="article-wrapper"><dl><dd>01</dd> <dt><a href="/myblog/" class="router-link-active"><div>
            首页
            <!----></div></a> <span class="date"></span></dt></dl><dl><dd>02</dd> <dt><a href="/myblog/pages/2faf0d/"><div>
            vscode操作git
            <!----></div></a> <span class="date">07-10</span></dt></dl><dl><dd>03</dd> <dt><a href="/myblog/pages/e6d2d9/"><div>
            前端资料网站
            <!----></div></a> <span class="date">07-10</span></dt></dl> <dl><dd></dd> <dt><a href="/myblog/archives/" class="more">更多文章&gt;</a></dt></dl></div></div></main></div> <div class="footer"><!----> 
  Theme by
  <a href="https://github.com/xugaoyi/vuepress-theme-vdoing" target="_blank" title="本站主题">Vdoing</a> <!----></div> <div class="buttons"><div title="返回顶部" class="button blur go-to-top iconfont icon-fanhuidingbu" style="display:none;"></div> <div title="去评论" class="button blur go-to-comment iconfont icon-pinglun" style="display:none;"></div> <div title="主题模式" class="button blur theme-mode-but iconfont icon-zhuti"><ul class="select-box" style="display:none;"><li class="iconfont icon-zidong">
          跟随系统
        </li><li class="iconfont icon-rijianmoshi">
          浅色模式
        </li><li class="iconfont icon-yejianmoshi">
          深色模式
        </li><li class="iconfont icon-yuedu">
          阅读模式
        </li></ul></div></div> <!----> <!----> <!----></div><div class="global-ui"></div></div>
    <script src="/myblog/assets/js/app.67ec3bdb.js" defer></script><script src="/myblog/assets/js/2.dd8fbd6f.js" defer></script><script src="/myblog/assets/js/5.ab7fc5be.js" defer></script>
  </body>
</html>
