(window.webpackJsonp=window.webpackJsonp||[]).push([[14],{381:function(s,a,t){s.exports=t.p+"assets/img/image-20230707212727301.40c0f718.png"},382:function(s,a,t){s.exports=t.p+"assets/img/image-20230707212758028.56ddba9a.png"},383:function(s,a,t){s.exports=t.p+"assets/img/image-20230707212824076.f63e9161.png"},469:function(s,a,t){"use strict";t.r(a);var n=t(4),e=Object(n.a)({},(function(){var s=this,a=s.$createElement,n=s._self._c||a;return n("ContentSlotsDistributor",{attrs:{"slot-key":s.$parent.slotKey}},[n("h2",{attrs:{id:"_1-堆空间和栈空间"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#_1-堆空间和栈空间"}},[s._v("#")]),s._v(" 1.堆空间和栈空间")]),s._v(" "),n("div",{staticClass:"language-js line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-js"}},[n("code",[s._v("JavaScript 就是动态语言，因为在声明变量之前并不需要确认其数据类型。 弱类型语言\n支持隐式类型转换的语言称为弱类型语言\n弱类型，意味着你不需要告诉 JavaScript 引擎这个或那个变量是什么数据类型，\nJavaScript 引擎在运行代码的时候自己会计算出来。\n动态，意味着你可以使用同一个变量保存不同类型的数据。\n")])]),s._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[s._v("1")]),n("br"),n("span",{staticClass:"line-number"},[s._v("2")]),n("br"),n("span",{staticClass:"line-number"},[s._v("3")]),n("br"),n("span",{staticClass:"line-number"},[s._v("4")]),n("br"),n("span",{staticClass:"line-number"},[s._v("5")]),n("br")])]),n("h2",{attrs:{id:"_2-数据类型"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#_2-数据类型"}},[s._v("#")]),s._v(" 2.数据类型")]),s._v(" "),n("div",{staticClass:"language-js line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-js"}},[n("code",[n("span",{pre:!0,attrs:{class:"token function"}},[s._v("基本数据类型：")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("简单数据类型"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("Number "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("2")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("String "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("3")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("null "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("4.")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("undefined")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("5")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("Boolean "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("6")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("BigInt "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("7")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("Symbol\n"),n("span",{pre:!0,attrs:{class:"token function"}},[s._v("引用数据类型：")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("复杂数据类型"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("1.")]),s._v(" Object\n\n我们把前面的 "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("7")]),s._v(" 种数据类型称为原始类型，把最后一个对象类型称为引用类型，\n之所以把它们区分为两种不同的类型，是因为它们在内存中存放的位置不一样\n")])]),s._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[s._v("1")]),n("br"),n("span",{staticClass:"line-number"},[s._v("2")]),n("br"),n("span",{staticClass:"line-number"},[s._v("3")]),n("br"),n("span",{staticClass:"line-number"},[s._v("4")]),n("br"),n("span",{staticClass:"line-number"},[s._v("5")]),n("br"),n("span",{staticClass:"line-number"},[s._v("6")]),n("br"),n("span",{staticClass:"line-number"},[s._v("7")]),n("br")])]),n("h2",{attrs:{id:"_3-内存空间"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#_3-内存空间"}},[s._v("#")]),s._v(" 3.内存空间")]),s._v(" "),n("p",[n("img",{attrs:{src:t(381),alt:"Algolia搜索"}})]),s._v(" "),n("div",{staticClass:"language-js line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-js"}},[n("code",[s._v("在 JavaScript 的执行过程中， 主要有三种类型内存空间，分别是代码空间、栈空间和堆空间。\n")])]),s._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[s._v("1")]),n("br")])]),n("h3",{attrs:{id:"_3-1栈空间和堆空间"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#_3-1栈空间和堆空间"}},[s._v("#")]),s._v(" 3.1栈空间和堆空间")]),s._v(" "),n("div",{staticClass:"language-js line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-js"}},[n("code",[n("span",{pre:!0,attrs:{class:"token number"}},[s._v("1.")]),s._v("栈空间是用来存储执行上下文的\n简单数据类型的数据值直接就是保存在当前执行上下文中的变量环境中的\n引用数据类型是把地址在栈中报存，值存放在堆空间里的\n")])]),s._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[s._v("1")]),n("br"),n("span",{staticClass:"line-number"},[s._v("2")]),n("br"),n("span",{staticClass:"line-number"},[s._v("3")]),n("br")])]),n("p",[n("strong",[s._v("为什么需要栈和堆两个空间")])]),s._v(" "),n("div",{staticClass:"language-js line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-js"}},[n("code",[s._v("因为 JavaScript 引擎需要用栈来维护程序执行期间上下文的状态，如果栈空间大了话，所有的数据都存放在栈空间里面，那么会影响到上下文切换的效率，进而又影响到整个程序的执行效率。比如文中的 foo 函数执行结束了，JavaScript 引擎需要离开当前的执行上下文，只需要将指针下移到上个执行上下文的地址就可以了，foo 函数执行上下文栈区空间全部回收，\n")])]),s._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[s._v("1")]),n("br")])]),n("p",[n("img",{attrs:{src:t(382),alt:"Algolia搜索"}})]),s._v(" "),n("div",{staticClass:"language-js line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-js"}},[n("code",[s._v("所以通常情况下，栈空间都不会设置太大，主要用来存放一些原始类型的小数据。而引用类\n型的数据占用的空间都比较大，所以这一类数据会被存放到堆中，堆空间很大，能存放很多\n大的数据，不过缺点是分配内存和回收内存都会占用一定的时间。\n")])]),s._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[s._v("1")]),n("br"),n("span",{staticClass:"line-number"},[s._v("2")]),n("br"),n("span",{staticClass:"line-number"},[s._v("3")]),n("br")])]),n("div",{staticClass:"language-js line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-js"}},[n("code",[s._v("原始类型的赋值会完整复制变量值，而引用类型的赋值是复制引用地址。\n")])]),s._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[s._v("1")]),n("br")])]),n("h2",{attrs:{id:"_4-闭包的产生过程"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#_4-闭包的产生过程"}},[s._v("#")]),s._v(" 4.闭包的产生过程")]),s._v(" "),n("div",{staticClass:"language-js line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-js"}},[n("code",[n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("function")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token function"}},[s._v("foo")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n "),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("var")]),s._v(" myName "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[s._v('" 极客时间 "')]),s._v("\n "),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("let")]),s._v(" test1 "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),s._v("\n "),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("const")]),s._v(" test2 "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("2")]),s._v("\n "),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("var")]),s._v(" innerBar "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v(" \n "),n("span",{pre:!0,attrs:{class:"token function-variable function"}},[s._v("setName")]),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("function")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),n("span",{pre:!0,attrs:{class:"token parameter"}},[s._v("newName")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n myName "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" newName\n "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("\n "),n("span",{pre:!0,attrs:{class:"token function-variable function"}},[s._v("getName")]),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("function")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n console"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),n("span",{pre:!0,attrs:{class:"token function"}},[s._v("log")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("test1"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n "),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("return")]),s._v(" myName\n "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n "),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("return")]),s._v(" innerBar\n"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("var")]),s._v(" bar "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token function"}},[s._v("foo")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\nbar"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),n("span",{pre:!0,attrs:{class:"token function"}},[s._v("setName")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),n("span",{pre:!0,attrs:{class:"token string"}},[s._v('" 极客邦 "')]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\nbar"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),n("span",{pre:!0,attrs:{class:"token function"}},[s._v("getName")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\nconsole"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),n("span",{pre:!0,attrs:{class:"token function"}},[s._v("log")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("bar"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),n("span",{pre:!0,attrs:{class:"token function"}},[s._v("getName")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n")])]),s._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[s._v("1")]),n("br"),n("span",{staticClass:"line-number"},[s._v("2")]),n("br"),n("span",{staticClass:"line-number"},[s._v("3")]),n("br"),n("span",{staticClass:"line-number"},[s._v("4")]),n("br"),n("span",{staticClass:"line-number"},[s._v("5")]),n("br"),n("span",{staticClass:"line-number"},[s._v("6")]),n("br"),n("span",{staticClass:"line-number"},[s._v("7")]),n("br"),n("span",{staticClass:"line-number"},[s._v("8")]),n("br"),n("span",{staticClass:"line-number"},[s._v("9")]),n("br"),n("span",{staticClass:"line-number"},[s._v("10")]),n("br"),n("span",{staticClass:"line-number"},[s._v("11")]),n("br"),n("span",{staticClass:"line-number"},[s._v("12")]),n("br"),n("span",{staticClass:"line-number"},[s._v("13")]),n("br"),n("span",{staticClass:"line-number"},[s._v("14")]),n("br"),n("span",{staticClass:"line-number"},[s._v("15")]),n("br"),n("span",{staticClass:"line-number"},[s._v("16")]),n("br"),n("span",{staticClass:"line-number"},[s._v("17")]),n("br"),n("span",{staticClass:"line-number"},[s._v("18")]),n("br"),n("span",{staticClass:"line-number"},[s._v("19")]),n("br")])]),n("div",{staticClass:"language-js line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-js"}},[n("code",[s._v("当执行这段代码的时候，你应该有过这样的分析：由于变量 myName、test1、test2 都是\n原始类型数据，所以在执行 foo 函数的时候，它们会被压入到调用栈中；当 foo 函数执行\n结束之后，调用栈中 foo 函数的执行上下文会被销毁，其内部变量 myName、test1、\ntest2 也应该一同被销毁。当 foo 函数的执行上下文销毁时，由于 foo 函数产生了闭\n包，所以变量 myName 和 test1 并没有被销毁，而是保存在内存中\n")])]),s._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[s._v("1")]),n("br"),n("span",{staticClass:"line-number"},[s._v("2")]),n("br"),n("span",{staticClass:"line-number"},[s._v("3")]),n("br"),n("span",{staticClass:"line-number"},[s._v("4")]),n("br"),n("span",{staticClass:"line-number"},[s._v("5")]),n("br")])]),n("p",[n("strong",[s._v("分析")])]),s._v(" "),n("div",{staticClass:"language-js line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-js"}},[n("code",[n("span",{pre:!0,attrs:{class:"token number"}},[s._v("1.")]),s._v(" 当 JavaScript 引擎执行到 foo 函数时，首先会编译，并创建一个空执行上下文。\n"),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("2.")]),s._v(" 在编译过程中，遇到内部函数 setName，JavaScript 引擎还要对内部函数做一次快速\n的词法扫描，发现该内部函数引用了 foo 函数中的 myName 变量，由于是内部函数引\n用了外部函数的变量，所以 JavaScript 引擎判断这是一个闭包，于是在堆空间创建换\n"),n("span",{pre:!0,attrs:{class:"token function"}},[s._v("一个“closure")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("foo"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("”的对象（这是一个内部对象，JavaScript 是无法访问的），用来\n保存 myName 变量。\n"),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("3.")]),s._v(" 接着继续扫描到 getName 方法时，发现该函数内部还引用变量 test1，于是\nJavaScript 引擎又将 test1 "),n("span",{pre:!0,attrs:{class:"token function"}},[s._v("添加到“closure")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("foo"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("”对象中。这时候堆中\n"),n("span",{pre:!0,attrs:{class:"token function"}},[s._v("的“closure")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("foo"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("”对象中就包含了 myName 和 test1 两个变量了。\n"),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("4.")]),s._v(" 由于 test2 并没有被内部函数引用，所以 test2 依然保存在调用栈中。\n")])]),s._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[s._v("1")]),n("br"),n("span",{staticClass:"line-number"},[s._v("2")]),n("br"),n("span",{staticClass:"line-number"},[s._v("3")]),n("br"),n("span",{staticClass:"line-number"},[s._v("4")]),n("br"),n("span",{staticClass:"line-number"},[s._v("5")]),n("br"),n("span",{staticClass:"line-number"},[s._v("6")]),n("br"),n("span",{staticClass:"line-number"},[s._v("7")]),n("br"),n("span",{staticClass:"line-number"},[s._v("8")]),n("br"),n("span",{staticClass:"line-number"},[s._v("9")]),n("br"),n("span",{staticClass:"line-number"},[s._v("10")]),n("br")])]),n("p",[n("img",{attrs:{src:t(383),alt:"Algolia搜索"}})]),s._v(" "),n("div",{staticClass:"language-js line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-js"}},[n("code",[s._v("当执行到 foo 函数时，闭包就产生了；当 foo 函数执行结束之\n后，返回的 getName 和 setName "),n("span",{pre:!0,attrs:{class:"token function"}},[s._v("方法都引用“clourse")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("foo"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("”对象，所以即使 foo 函数\n"),n("span",{pre:!0,attrs:{class:"token function"}},[s._v("退出了，“clourse")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("foo"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("”依然被其内部的 getName 和 setName 方法引用。所以在下次\n调用bar"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("setName或者bar"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("getName时，创建的执行上下文中就包含\n"),n("span",{pre:!0,attrs:{class:"token function"}},[s._v("了“clourse")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("foo"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("”。\n总的来说，产生闭包的核心有两步：第一步是需要预扫描内部函数；第二步是把内部函数引\n用的外部变量保存到堆中。\n")])]),s._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[s._v("1")]),n("br"),n("span",{staticClass:"line-number"},[s._v("2")]),n("br"),n("span",{staticClass:"line-number"},[s._v("3")]),n("br"),n("span",{staticClass:"line-number"},[s._v("4")]),n("br"),n("span",{staticClass:"line-number"},[s._v("5")]),n("br"),n("span",{staticClass:"line-number"},[s._v("6")]),n("br"),n("span",{staticClass:"line-number"},[s._v("7")]),n("br")])])])}),[],!1,null,null,null);a.default=e.exports}}]);